{
  "name": "Weekly Expense Summary Reporter",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtHour": 9
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.3,
      "position": [
        -384,
        -64
      ],
      "id": "95183ec4-8684-45c8-ac6a-b607080fa3ea",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT \n  category,\n  SUM(amount) AS total_spent,\n  COUNT(*) AS transactions\nFROM transactions_clean\nWHERE created_at >= NOW() - INTERVAL '7 days'\nGROUP BY category;\n",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -176,
        -64
      ],
      "id": "8cc8efe0-868b-4b99-9223-6a3e80f3da56",
      "name": "Execute a SQL query",
      "credentials": {
        "postgres": {
          "id": "0FnbB8Ar1b35DqLj",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "let report = \"ðŸ“Š Weekly Expense Summary\\n\\n\";\n\nitems.forEach(item => {\n  report += `${item.json.category}: â‚¹${item.json.total_spent} (${item.json.transactions} transactions)\\n`;\n});\n\nreturn [\n  {\n    json: {\n      report\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        32,
        -64
      ],
      "id": "2624fe36-9e1d-4c78-b33b-8412f6ec6ffe",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        240,
        -64
      ],
      "id": "37c6a998-5788-4c5e-82f5-2a580440c176",
      "name": "No Operation, do nothing"
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Execute a SQL query",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute a SQL query": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "38908d47-0816-4018-9167-0f21d065b8c8",
  "meta": {
    "instanceId": "0f375d2c46d7d7ee554f8abd19ef7e1ce3abb0a56858970c0bdf86d91ade2d28"
  },
  "id": "BwXUZRjvLxBMv7uklLQJM",
  "tags": []
}